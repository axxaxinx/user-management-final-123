"use strict";(self.webpackChunkangular_signup_verification_boilerplate=self.webpackChunkangular_signup_verification_boilerplate||[]).push([[538],{9538:(ee,v,a)=>{a.r(v),a.d(v,{RequestsModule:()=>K});var d=a(434),u=a(9351),m=a(1852),e=a(4292),p=a(878),R=a(6e3);let _=(()=>{class s{http;constructor(t){this.http=t}getAll(){return this.http.get(`${p.c.apiUrl}/requests`)}getById(t){return this.http.get(`${p.c.apiUrl}/requests/${t}`)}create(t){return this.http.post(`${p.c.apiUrl}/requests`,t)}update(t,n){return this.http.put(`${p.c.apiUrl}/requests/${t}`,n)}delete(t){return this.http.delete(`${p.c.apiUrl}/requests/${t}`)}static \u0275fac=function(n){return new(n||s)(e.KVO(R.Qq))};static \u0275prov=e.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var h=a(9933);const F=(s,r,t)=>({"bg-warning":s,"bg-success":r,"bg-danger":t});function q(s,r){1&s&&(e.j41(0,"span",19),e.EFF(1,"(Admin User)"),e.k0s())}function y(s,r){1&s&&(e.j41(0,"span",20),e.EFF(1,"(Normal User)"),e.k0s())}function b(s,r){if(1&s&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&s){const t=r.$implicit;e.R7$(),e.Lme(" ",t.name," (x",t.quantity,") ")}}function k(s,r){1&s&&(e.j41(0,"div"),e.EFF(1," - "),e.k0s())}function E(s,r){1&s&&e.nrm(0,"span",21)}function $(s,r){1&s&&(e.j41(0,"span"),e.EFF(1,"Delete"),e.k0s())}function j(s,r){if(1&s){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.DNE(5,q,2,0,"span",12)(6,y,2,0,"span",13),e.k0s(),e.j41(7,"td"),e.DNE(8,b,2,2,"div",8)(9,k,2,0,"div",9),e.k0s(),e.j41(10,"td")(11,"span",14),e.EFF(12),e.k0s()(),e.j41(13,"td")(14,"div",15)(15,"a",16),e.EFF(16,"Edit"),e.k0s(),e.j41(17,"button",17),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG();return e.Njj(l.deleteRequest(i.id))}),e.DNE(18,E,1,0,"span",18)(19,$,2,0,"span",9),e.k0s()()()()}if(2&s){const t=r.$implicit;e.R7$(2),e.JRh(t.type),e.R7$(2),e.SpI("",null==t.employee||null==t.employee.user?null:t.employee.user.email," "),e.R7$(),e.Y8G("ngIf","Admin"===(null==t.employee||null==t.employee.user?null:t.employee.user.role)),e.R7$(),e.Y8G("ngIf","User"===(null==t.employee||null==t.employee.user?null:t.employee.user.role)),e.R7$(2),e.Y8G("ngForOf",t.items),e.R7$(),e.Y8G("ngIf",!t.items||0===t.items.length),e.R7$(2),e.Y8G("ngClass",e.sMw(13,F,"Pending"===t.status,"Approved"===t.status,"Rejected"===t.status)),e.R7$(),e.JRh(t.status),e.R7$(3),e.Mz_("routerLink","edit/",t.id,""),e.R7$(2),e.Y8G("disabled",t.isDeleting),e.R7$(),e.Y8G("ngIf",t.isDeleting),e.R7$(),e.Y8G("ngIf",!t.isDeleting)}}function C(s,r){1&s&&(e.j41(0,"div",24),e.nrm(1,"span",25),e.k0s())}function I(s,r){1&s&&(e.j41(0,"div"),e.EFF(1," No requests found "),e.k0s())}function G(s,r){if(1&s&&(e.j41(0,"tr")(1,"td",22),e.DNE(2,C,2,0,"div",23)(3,I,2,0,"div",9),e.k0s()()),2&s){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",t.loading),e.R7$(),e.Y8G("ngIf",!t.loading)}}let g=(()=>{class s{requestService;alertService;requests=[];loading=!1;constructor(t,n){this.requestService=t,this.alertService=n}ngOnInit(){this.loading=!0,this.requestService.getAll().pipe((0,m.$)()).subscribe({next:t=>{this.requests=t,this.loading=!1},error:t=>{this.alertService.error(t),this.loading=!1}})}deleteRequest(t){const n=this.requests.find(i=>i.id===t);n.isDeleting=!0,this.requestService.delete(t).pipe((0,m.$)()).subscribe({next:()=>{this.requests=this.requests.filter(i=>i.id!==t),this.alertService.success("Request deleted successfully")},error:i=>{this.alertService.error(i),n.isDeleting=!1}})}static \u0275fac=function(n){return new(n||s)(e.rXU(_),e.rXU(h.uE))};static \u0275cmp=e.VBU({type:s,selectors:[["app-requests-list"]],standalone:!0,features:[e.aNF],decls:24,vars:2,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-striped"],[2,"width","15%"],[2,"width","25%"],[2,"width","20%"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"text-end","mt-3"],["routerLink","add",1,"btn","btn-primary"],["class","text-danger",4,"ngIf"],["class","text-primary",4,"ngIf"],[1,"badge",3,"ngClass"],[1,"btn-group"],[1,"btn","btn-primary",3,"routerLink"],[1,"btn","btn-danger",3,"click","disabled"],["class","spinner-border spinner-border-sm",4,"ngIf"],[1,"text-danger"],[1,"text-primary"],[1,"spinner-border","spinner-border-sm"],["colspan","5",1,"text-center"],["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"spinner-border","spinner-border-lg"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"h4",1),e.EFF(2,"REQUESTS"),e.k0s(),e.j41(3,"div",2)(4,"div",3)(5,"table",4)(6,"thead")(7,"tr")(8,"th",5),e.EFF(9,"Type"),e.k0s(),e.j41(10,"th",6),e.EFF(11,"Employee"),e.k0s(),e.j41(12,"th",6),e.EFF(13,"Items"),e.k0s(),e.j41(14,"th",5),e.EFF(15,"Status"),e.k0s(),e.j41(16,"th",7),e.EFF(17,"Actions"),e.k0s()()(),e.j41(18,"tbody"),e.DNE(19,j,20,17,"tr",8)(20,G,4,2,"tr",9),e.k0s()()(),e.j41(21,"div",10)(22,"a",11),e.EFF(23,"Add Request"),e.k0s()()()()),2&n&&(e.R7$(19),e.Y8G("ngForOf",i.requests),e.R7$(),e.Y8G("ngIf",!i.requests||0===i.requests.length))},dependencies:[u.MD,u.YU,u.Sq,u.bT,d.iI,d.Wk],encapsulation:2})}return s})();var o=a(7199),T=a(9557);const c=s=>({"is-invalid":s});function S(s,r){if(1&s&&(e.j41(0,"option",18),e.EFF(1),e.k0s()),2&s){const t=r.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function Y(s,r){1&s&&(e.j41(0,"div"),e.EFF(1,"Type is required"),e.k0s())}function N(s,r){if(1&s&&(e.j41(0,"div",19),e.DNE(1,Y,2,0,"div",20),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.f.type.errors.required)}}function x(s,r){if(1&s&&(e.j41(0,"option",18),e.EFF(1),e.k0s()),2&s){const t=r.$implicit;e.Y8G("value",t.id),e.R7$(),e.Lme(" ",null==t.user?null:t.user.email," (",t.id,") ")}}function D(s,r){1&s&&(e.j41(0,"div"),e.EFF(1,"Employee is required"),e.k0s())}function A(s,r){if(1&s&&(e.j41(0,"div",19),e.DNE(1,D,2,0,"div",20),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.f.employeeId.errors.required)}}function U(s,r){if(1&s&&(e.j41(0,"option",18),e.EFF(1),e.k0s()),2&s){const t=r.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function X(s,r){1&s&&(e.j41(0,"div"),e.EFF(1,"Status is required"),e.k0s())}function L(s,r){if(1&s&&(e.j41(0,"div",19),e.DNE(1,X,2,0,"div",20),e.k0s()),2&s){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.f.status.errors.required)}}function O(s,r){if(1&s&&(e.j41(0,"div",4)(1,"label",5),e.EFF(2,"Status"),e.k0s(),e.j41(3,"div",6)(4,"select",21),e.DNE(5,U,2,2,"option",9),e.k0s(),e.DNE(6,L,2,1,"div",10),e.k0s()()),2&s){const t=e.XpG();e.R7$(4),e.Y8G("ngClass",e.eq3(3,c,t.submitted&&t.f.status.errors)),e.R7$(),e.Y8G("ngForOf",t.statusOptions),e.R7$(),e.Y8G("ngIf",t.submitted&&t.f.status.errors)}}function B(s,r){1&s&&(e.j41(0,"div"),e.EFF(1,"Name is required"),e.k0s())}function M(s,r){if(1&s&&(e.j41(0,"div",19),e.DNE(1,B,2,0,"div",20),e.k0s()),2&s){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",t.get("name").errors.required)}}function V(s,r){1&s&&(e.j41(0,"div"),e.EFF(1,"Quantity is required"),e.k0s())}function w(s,r){1&s&&(e.j41(0,"div"),e.EFF(1,"Quantity must be at least 1"),e.k0s())}function Q(s,r){if(1&s&&(e.j41(0,"div",19),e.DNE(1,V,2,0,"div",20)(2,w,2,0,"div",20),e.k0s()),2&s){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",t.get("quantity").errors.required),e.R7$(),e.Y8G("ngIf",t.get("quantity").errors.min)}}function J(s,r){if(1&s){const t=e.RV6();e.j41(0,"tr",31)(1,"td"),e.nrm(2,"input",32),e.DNE(3,M,2,1,"div",10),e.k0s(),e.j41(4,"td"),e.nrm(5,"input",33),e.DNE(6,Q,3,2,"div",10),e.k0s(),e.j41(7,"td",34)(8,"button",35),e.bIt("click",function(){const i=e.eBV(t).index,l=e.XpG(2);return e.Njj(l.removeItem(i))}),e.EFF(9,"Remove"),e.k0s()()()}if(2&s){const t=r.$implicit,n=r.index,i=e.XpG(2);e.Y8G("formGroupName",n),e.R7$(2),e.Y8G("ngClass",e.eq3(5,c,i.submitted&&t.get("name").errors)),e.R7$(),e.Y8G("ngIf",i.submitted&&t.get("name").errors),e.R7$(2),e.Y8G("ngClass",e.eq3(7,c,i.submitted&&t.get("quantity").errors)),e.R7$(),e.Y8G("ngIf",i.submitted&&t.get("quantity").errors)}}function P(s,r){if(1&s){const t=e.RV6();e.j41(0,"div",22)(1,"label",23),e.EFF(2,"Items"),e.k0s(),e.j41(3,"div",24)(4,"table",25)(5,"thead")(6,"tr")(7,"th",26),e.EFF(8,"Name"),e.k0s(),e.j41(9,"th",26),e.EFF(10,"Quantity"),e.k0s(),e.nrm(11,"th",27),e.k0s()(),e.j41(12,"tbody",28),e.DNE(13,J,10,9,"tr",29),e.k0s()()(),e.j41(14,"div",30)(15,"button",17),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.addItem())}),e.EFF(16,"Add Item"),e.k0s()()()}if(2&s){const t=e.XpG();e.R7$(13),e.Y8G("ngForOf",t.itemsArray.controls)}}function z(s,r){1&s&&e.nrm(0,"span",36)}let f=(()=>{class s{formBuilder;route;router;requestService;employeeService;alertService;form;id;isAddMode;loading=!1;submitted=!1;employees=[];requestTypes=["Equipment","Resources","Leave"];statusOptions=["Pending","Approved","Rejected"];itemRequiredTypes=["Equipment","Resources"];constructor(t,n,i,l,W,Z){this.formBuilder=t,this.route=n,this.router=i,this.requestService=l,this.employeeService=W,this.alertService=Z}ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.employeeService.getAll().pipe((0,m.$)()).subscribe({next:t=>this.employees=t,error:t=>this.alertService.error(t)}),this.form=this.formBuilder.group({type:["",o.k0.required],employeeId:["",o.k0.required],status:[{value:"Pending",disabled:this.isAddMode},o.k0.required],items:this.formBuilder.array([])}),this.form.get("type")?.valueChanges.subscribe(t=>{this.itemRequiredTypes.includes(t)||this.itemsArray.clear()}),this.isAddMode||(this.loading=!0,this.requestService.getById(parseInt(this.id)).pipe((0,m.$)()).subscribe({next:t=>{this.form.patchValue({type:t.type,employeeId:t.employeeId,status:t.status}),this.itemsArray.clear(),this.itemRequiredTypes.includes(t.type)&&t.items&&t.items.forEach(n=>{this.itemsArray.push(this.formBuilder.group({name:[n.name,o.k0.required],quantity:[n.quantity,[o.k0.required,o.k0.min(1)]]}))}),this.loading=!1},error:t=>{this.alertService.error(t),this.loading=!1}}))}showItemsSection(){const t=this.form.get("type")?.value;return this.itemRequiredTypes.includes(t)}get f(){return this.form.controls}get itemsArray(){return this.form.get("items")}addItem(){const t=this.formBuilder.group({name:["",o.k0.required],quantity:[1,[o.k0.required,o.k0.min(1)]]});this.itemsArray.push(t)}removeItem(t){this.itemsArray.removeAt(t)}onSubmit(){if(this.submitted=!0,this.alertService.clear(),this.form.invalid)return;const t=this.form.get("type")?.value;this.itemRequiredTypes.includes(t)&&0===this.itemsArray.length?this.alertService.error(`Please add at least one item to the ${t.toLowerCase()} request`):(this.loading=!0,this.isAddMode?this.createRequest():this.updateRequest())}onCancel(){this.router.navigate(this.isAddMode?["../"]:["../../"],{relativeTo:this.route})}createRequest(){this.requestService.create(this.form.getRawValue()).pipe((0,m.$)()).subscribe({next:()=>{this.alertService.success("Request added successfully",{keepAfterRouteChange:!0}),this.router.navigate(["../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}})}updateRequest(){this.requestService.update(parseInt(this.id),this.form.getRawValue()).pipe((0,m.$)()).subscribe({next:()=>{this.alertService.success("Request updated successfully",{keepAfterRouteChange:!0}),this.router.navigate(["../../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}})}static \u0275fac=function(n){return new(n||s)(e.rXU(o.ze),e.rXU(d.nX),e.rXU(d.Ix),e.rXU(_),e.rXU(T.O),e.rXU(h.uE))};static \u0275cmp=e.VBU({type:s,selectors:[["app-requests-form"]],standalone:!0,features:[e.aNF],decls:29,vars:16,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3","row"],[1,"col-sm-2","col-form-label"],[1,"col-sm-10"],["formControlName","type",1,"form-select",3,"ngClass"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["formControlName","employeeId",1,"form-select",3,"ngClass"],["class","mb-3 row",4,"ngIf"],["class","mb-4",4,"ngIf"],[1,"d-flex","justify-content-center","mt-4"],[1,"btn","btn-primary","me-2",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],[3,"value"],[1,"invalid-feedback"],[4,"ngIf"],["formControlName","status",1,"form-select",3,"ngClass"],[1,"mb-4"],[1,"col-form-label"],[1,"table-responsive"],[1,"table","table-borderless"],[2,"width","45%"],[2,"width","10%"],["formArrayName","items"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-start","mb-3"],[3,"formGroupName"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],["type","number","formControlName","quantity",1,"form-control",3,"ngClass"],[1,"text-center"],["type","button",1,"btn","btn-danger",3,"click"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"h4",1),e.EFF(2),e.k0s(),e.j41(3,"div",2)(4,"form",3),e.bIt("ngSubmit",function(){return i.onSubmit()}),e.j41(5,"div",4)(6,"label",5),e.EFF(7,"Type"),e.k0s(),e.j41(8,"div",6)(9,"select",7),e.nrm(10,"option",8),e.DNE(11,S,2,2,"option",9),e.k0s(),e.DNE(12,N,2,1,"div",10),e.k0s()(),e.j41(13,"div",4)(14,"label",5),e.EFF(15,"Employee"),e.k0s(),e.j41(16,"div",6)(17,"select",11),e.nrm(18,"option",8),e.DNE(19,x,2,3,"option",9),e.k0s(),e.DNE(20,A,2,1,"div",10),e.k0s()(),e.DNE(21,O,7,5,"div",12)(22,P,17,1,"div",13),e.j41(23,"div",14)(24,"button",15),e.DNE(25,z,1,0,"span",16),e.EFF(26," Save "),e.k0s(),e.j41(27,"button",17),e.bIt("click",function(){return i.onCancel()}),e.EFF(28,"Cancel"),e.k0s()()()()()),2&n&&(e.R7$(2),e.JRh(i.isAddMode?"ADD REQUEST":"EDIT REQUEST"),e.R7$(2),e.Y8G("formGroup",i.form),e.R7$(5),e.Y8G("ngClass",e.eq3(12,c,i.submitted&&i.f.type.errors)),e.R7$(2),e.Y8G("ngForOf",i.requestTypes),e.R7$(),e.Y8G("ngIf",i.submitted&&i.f.type.errors),e.R7$(5),e.Y8G("ngClass",e.eq3(14,c,i.submitted&&i.f.employeeId.errors)),e.R7$(2),e.Y8G("ngForOf",i.employees),e.R7$(),e.Y8G("ngIf",i.submitted&&i.f.employeeId.errors),e.R7$(),e.Y8G("ngIf",!i.isAddMode),e.R7$(),e.Y8G("ngIf",i.showItemsSection()),e.R7$(2),e.Y8G("disabled",i.loading),e.R7$(),e.Y8G("ngIf",i.loading))},dependencies:[u.MD,u.YU,u.Sq,u.bT,o.X1,o.qT,o.xH,o.y7,o.me,o.Q0,o.wz,o.BC,o.cb,o.j4,o.JD,o.$R,o.v8,d.iI],encapsulation:2})}return s})();const H=[{path:"",component:g},{path:"add",component:f},{path:"edit/:id",component:f}];let K=(()=>{class s{static \u0275fac=function(n){return new(n||s)};static \u0275mod=e.$C({type:s});static \u0275inj=e.G2t({imports:[d.iI.forChild(H),g,f]})}return s})()}}]);